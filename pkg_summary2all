#!/bin/sh

. ./pkg_online_fields.sh

#
set -e

#
usage (){
    echo 'usage: pkg_summary2all <bin|src> <files...>' 1>&2
}

if test $# -gt 2 || test _$1 '!=' _bin -a _$1 '!=' _src
then
    usage
    exit 1
fi

#
binsrc=$1
shift;

if test _$binsrc = _bin
then
    fields="$fields_bin"
else
    fields="$fields_src"
fi

export PKG_SUMMARY_TYPE=$binsrc

# fields indices
for i in $fields
do
    printf "index for field %s" $i...
    ./pkg_summary2field-index $i "$@"
    printf "done\n"
done

# whole information
printf "%s" 'information about packages...'
./pkg_summary2dict "$@"
printf "done\n"

# pkgname2comment
printf 'pkgname2comment...'
./pkg_summary2pkgname_to_comment "$@"
printf "done\n"
